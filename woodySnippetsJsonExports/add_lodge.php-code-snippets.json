{"generator":"PHP Code Snippets v2.3.1","date_created":"2020-09-29 22:29","snippets":[{"name":"add_lodge","title":"add_lodge","content":"if (!defined('SCRIPTS_DIR')) {\r\n\tdefine('SCRIPTS_DIR', '\/home1\/templark\/scripts');\r\n}\r\nrequire_once(SCRIPTS_DIR.'\/includes\/defines.inc');\r\nrequire_once(SCRIPTS_DIR.'\/classes\/Database.class');\r\n\/\/Connect To Database\r\n$db = LocalDatabase::getReadable('master');\r\n$ltable='lodge_directory';\r\n\r\nif(isset($_GET[\"success\"])) {\r\n    $query = 'SELECT * FROM ' . $table . ' ORDER BY LODGE_NUM DESC LIMIT 1';\r\n    $result = mysqli_query($db->connection, $query);\r\n    if($result) {\r\n      $row = mysqli_fetch_array($result);\r\n      echo 'You successfully added <strong>' . $row['LODGE_NAME'] . '<\/strong> Lodge.';\r\n    }\r\n} else {\r\n\techo '<form action=\"http:\/\/templarknightsmc.com\/scripts\/addlodge_action.php\" method=\"post\">';\r\n\techo '<p>Lodge Code (Lowercase name of the Lodge with an underscore for a space): <input type=\"text\" name=\"lodgeCode\" \/><\/p>';\r\n\techo 'Lodge Name: <input type=\"text\" name=\"lodgeName\" \/><p>';\r\n\techo 'City: <input type=\"text\" name=\"city\" \/><p>';\r\n\techo 'State (No Abbreviation): <input type=\"text\" name=\"state\" \/><p>';\r\n\techo 'Country: <input type=\"text\" name=\"country\" \/><p>';\r\n\techo 'Lodge eMail Address: <input type=\"text\" name=\"emailAddr\" value=\"@templarknightsmc.com\" size=\"50\" \/><p>';\r\n\techo 'Lodge Website URL: <input type=\"text\" name=\"webAddr\" value=\"http:\/\/templarknightsmc.com\" size=\"50\" \/><p>';\r\n\techo 'Lodge Facebook URL: <input type=\"text\" name=\"fbAddr\" value=\"https:\/\/www.facebook.com\/templarknightsmc\" size=\"50\" \/><p>';\r\n\techo 'Lodge Twitter URL: <input type=\"text\" name=\"twitterAddr\" value=\"http:\/\/twitter.com\/TemplarKnightMC\" size=\"50\" \/><p>';\r\n\techo 'Lodge YouTube URL: <input type=\"text\" name=\"youtubeAddr\" value=\"http:\/\/youtube.com\/user\/TemplarKnightsMc\" size=\"50\" \/><p>';\r\n\techo '<p>Dues Month:<br><select name=\"duesMonth\">';\r\n\t$query = \"SHOW COLUMNS FROM \" . $ltable . \" LIKE 'DUES_MONTH'\";\r\n\t$result = mysqli_query($db->connection, $query);\r\n\tif($result) {\r\n\t\t$row = mysqli_fetch_array($result);\r\n\t\t#Extract the values\r\n\t\t#The values are enclosed in single quotes and seperated by commas\r\n\t\t$regex = \"\/'(.*?)'\/\";\r\n\t\tpreg_match_all($regex, $row[1], $enum_array);\r\n\t\t$i = 0;\r\n\t\tforeach($enum_array[1] as $value) {\r\n\t\t\techo '<option value=\"' . $i . '\">' . $value . '<\/option>';\r\n\t\t\t$i++;\r\n\t\t}\r\n\t\techo '<option selected=\"yes\" value=\"12\">- Select -<\/option>';\r\n\t}\r\n\techo '<\/select><\/p>';\r\n\techo '<p><input type=\"submit\" value=\"Create Record\"><\/p>';\r\n\techo '<\/form>';\r\n }\r\nmysqli_close($db->connection);","location":"","type":"php","filters":"","changed_filters":"","scope":"shortcode","description":"PHP Script to add a lodge record","attributes":"","tags":[]}]}