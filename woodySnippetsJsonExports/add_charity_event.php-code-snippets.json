{"generator":"PHP Code Snippets v2.3.1","date_created":"2020-09-29 22:28","snippets":[{"name":"add_charity_event","title":"add_charity_event","content":"if (!defined('SCRIPTS_DIR')) {\r\n\tdefine('SCRIPTS_DIR', '\/home1\/templark\/scripts');\r\n}\r\nrequire_once(SCRIPTS_DIR.'\/includes\/defines.inc');\r\nrequire_once(SCRIPTS_DIR.'\/includes\/form_functions.inc');\r\nrequire_once(SCRIPTS_DIR.'\/classes\/Database.class');\r\n\/\/Connect To Database\r\n$db = LocalDatabase::getReadable('master');\r\n$ltable='lodge_directory';\r\n$ctable='fin_charity_events';\r\n$stable='fin_sponsors';\r\n\r\necho '<style type=\"text\/css\">.charity input{background: aliceblue;} .charity textarea{background: aliceblue;}<\/style>';\r\n\r\nif (isset($_GET['success'])) {\r\n\techo '<p>Event was successfully added.<\/p>';\r\n}\r\n\r\necho '<div class=\"charity\"><form action=\"http:\/\/templarknightsmc.com\/scripts\/addcharityevent_action.php\" method=\"post\"><table>';\r\necho '<tr><td>Event Name:<\/td><td><input type=\"text\" name=\"eventName\" \/><\/tr>';\r\necho '<tr><td>Event Year:<\/td><td><select name=\"year\">';\r\n$todaysDate = getDate();\r\necho '<option value=\"' . ($todaysDate['year'] - 2) . '\">' . ($todaysDate['year'] - 2) . '<\/option>';\r\necho '<option value=\"' . ($todaysDate['year'] - 1) . '\">' . ($todaysDate['year'] - 1) . '<\/option>';\r\necho '<option selected=\"yes\" value=\"' . $todaysDate['year'] . '\">' . $todaysDate['year'] . '<\/option>';\r\necho '<\/select><\/td><\/tr>';\r\necho '<tr><td>Amount (no commas, just numbers):<\/td><td><input type=\"text\" name=\"amount\" \/><\/td><\/tr>';\r\necho '<tr><td>Sponsor:<\/td><td><input type=\"text\" name=\"sponsor\">';\r\necho '<tr><td>Reason:<\/td><td><input type=\"text\" name=\"reason\" \/><\/td><\/tr>';\r\necho '<tr><td>Sponsoring Lodge:<\/td><td>'.lodge_dropdown_only($db, $ltable).'<\/td><\/tr><\/table><\/div>';\r\necho '<input type=\"submit\" value=\"Record Event\"><\/form><br \/>';\r\nmysqli_close($db->connection);\r\n\r\n$db = LocalDatabase::getReadable('finance');\r\n$query = 'SELECT * FROM ' . $ctable . ' ORDER BY YEAR DESC';\r\n$result = mysqli_query($db->connection, $query);\r\necho '<div style=\"height:709px;width:900px;overflow-x:hidden;overflow-y:scroll;\"><table><tr><th>Charitable Event<\/th><th>Year<\/th><th>Amount Raised<\/th><th>Sponsor<\/th><th>Reason<\/th><\/tr>';\r\n\r\n$moneyFormat = '%=_#12n';\r\nsetlocale(LC_MONETARY, 'en_US');\r\n\r\nif($result) {\r\nwhile($row = mysqli_fetch_array($result)){\r\n\techo '<tr><td>' . $row['EVENT'] . '<\/td><td>' . $row['YEAR'] . '<\/td><td align=\"right\">' . money_format($moneyFormat, $row['AMOUNT_RAISED']) . '<\/td><td>' . $row['SPONSOR'] . '<\/td><td>' . $row['REASON'] . '<\/td><td><\/tr>';\r\n}\r\n}\r\necho '<\/table><\/div>';\r\nmysqli_close($db->connection);","location":"","type":"php","filters":"","changed_filters":"","scope":"shortcode","description":"PHP script to add a charity event","attributes":"","tags":[]}]}