{"generator":"PHP Code Snippets v2.3.1","date_created":"2020-09-29 22:30","snippets":[{"name":"templar_wisdom_random","title":"templar_wisdom_random","content":"if (!defined('SCRIPTS_DIR')) {\r\n\tdefine('SCRIPTS_DIR', '\/home1\/templark\/scripts');\r\n}\r\nrequire_once(SCRIPTS_DIR.'\/includes\/defines.inc');\r\nrequire_once(SCRIPTS_DIR.'\/classes\/Database.class');\r\nrequire_once(SCRIPTS_DIR.'\/includes\/form_functions.inc');\r\n\r\n\/\/Connect to Database\r\n$db = LocalDatabase::getReadable('master');\r\n$qtable='quotes';\r\n$ktable='knight_directory';\r\n$ltable='lodge_directory';\r\n$displayrow=1;\r\n\r\n$query = 'SELECT COUNT(*) FROM ' . $qtable;\r\n$result = mysqli_query($db->connection, $query);\r\nif($result) {\r\n\twhile($row = mysqli_fetch_array($result)) {\r\n\t\t$displayrow = rand(1, $row[0]);\r\n\t\t$query = 'SELECT q.quote AS quote, k.nickname AS nickname, k.fname AS fname, l.lodge_name AS lodgename FROM quotes AS q, knight_directory AS k, lodge_directory AS l WHERE q.knight_num = k.record_num AND k.lodge = l.lodge_num AND q.record_num = '. $displayrow;\r\n\t\t$result = mysqli_query($db->connection, $query);\r\n\t\tif($result) {\r\n\t\t\twhile($row = mysqli_fetch_array($result)) {\r\n\t\t\t\techo '<table><tr><td><p style=\"font-size:16px\">' . $row['quote'] . ' - ';\r\n\t\t\t\tif($row['nickname'] == \"\") {\r\n\t\t\t\t\techo $row['fname'];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\techo $row['nickname'];\r\n\t\t\t\t}\r\n\t\t\t\techo ' [' . $row['lodgename'] . ']<\/p><\/td><\/tr><\/table>';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nmysqli_close($db->connection);","location":"","type":"php","filters":"","changed_filters":"","scope":"shortcode","description":"PHP script to show random quotes","attributes":"","tags":[]}]}